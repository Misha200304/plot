<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Coordinate Plane</title>
  <style>
    :root {
      --blue-100: #dbeafe;
      --blue-300: #93c5fd;
      --blue-500: #3b82f6;
      --blue-600: #2563eb;
      --blue-700: #1d4ed8;
      --ink-900: #0b1220;
      --ink-700: #1f2937;
      --grid: rgba(255,255,255,0.35);
      --axis: #0b1220;
      --success: #16a34a;
      --error: #dc2626;
      --surface: rgba(255,255,255,0.9);
    }
    html, body {
      min-height: 100vh;
      background: linear-gradient(135deg, var(--blue-500) 0%, var(--blue-600) 50%, var(--blue-700) 100%);
      font-family: 'Inter', 'Poppins', 'Rubik', Arial, sans-serif;
      color: var(--ink-900);
      font-size: 16px;
      font-weight: 400;
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    .app {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 24px 0;
    }
    .card {
      background: var(--surface);
      border-radius: 20px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.18);
      backdrop-filter: blur(8px);
      max-width: 920px;
      width: 100%;
      padding: 32px 32px 24px 32px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 16px;
    }
    .header {
      width: 100%;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      margin-bottom: 8px;
    }
    .header-title {
      font-size: 2em;
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .chips {
      display: flex;
      gap: 8px;
    }
    .chip {
      background: rgba(255,255,255,0.85);
      color: var(--ink-900);
      border-radius: 999px;
      padding: 4px 14px 4px 10px;
      font-size: 1em;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 4px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    }
    .divider {
      width: 100%;
      height: 1px;
      background: var(--grid);
      margin: 8px 0 0 0;
      border-radius: 2px;
    }
    .task-badge {
      background: var(--blue-600);
      color: #fff;
      font-weight: 600;
      font-size: 1.1em;
      border-radius: 999px;
      padding: 8px 24px;
      box-shadow: 0 0 12px var(--blue-300);
      margin-bottom: 4px;
      letter-spacing: 0.5px;
      text-align: center;
      filter: drop-shadow(0 2px 8px var(--blue-100));
    }
    .canvas-wrap {
      background: var(--surface);
      border-radius: 20px;
      box-shadow: 0 4px 16px rgba(0,0,0,0.10);
      padding: 16px;
      margin-bottom: 8px;
      position: relative;
      display: flex;
      justify-content: center;
      align-items: center;
      min-width: 600px;
    }
    #canvas {
      display: block;
      border-radius: 16px;
      box-shadow: 0 1px 6px rgba(0,0,0,0.06);
      background: #fff;
    }
    .status {
      font-size: 1.1em;
      color: var(--ink-700);
      margin-bottom: 2px;
      font-weight: 500;
    }
    .controls {
      display: flex;
      gap: 16px;
      margin-bottom: 8px;
      width: 100%;
      justify-content: center;
    }
    .btn {
      padding: 10px 32px;
      font-size: 1em;
      font-weight: 600;
      border-radius: 12px;
      border: none;
      background: linear-gradient(135deg, var(--blue-500), var(--blue-700));
      color: #fff;
      box-shadow: 0 8px 20px rgba(29,78,216,0.18);
      cursor: pointer;
      transition: background 0.2s, box-shadow 0.2s, transform 0.18s;
      outline: none;
      position: relative;
    }
    .btn:disabled {
      filter: grayscale(0.5) brightness(0.92);
      box-shadow: none;
      cursor: not-allowed;
    }
    .btn:focus {
      outline: 2px solid var(--blue-300);
      outline-offset: 2px;
    }
    .btn:hover:not(:disabled) {
      background: linear-gradient(135deg, var(--blue-600), var(--blue-700));
      box-shadow: 0 0 0 6px var(--blue-300);
      transform: translateY(-1px);
    }
    .feedback {
      font-size: 1.15em;
      font-weight: bold;
      min-height: 1.5em;
      margin-bottom: 8px;
      transition: color 0.2s, transform 0.18s;
      text-align: center;
    }
    .feedback.success {
      color: var(--success);
      animation: scaleIn 0.18s cubic-bezier(0.2,0.8,0.2,1);
    }
    .feedback.error {
      color: var(--error);
      animation: shake 0.22s cubic-bezier(0.2,0.8,0.2,1);
    }
    @keyframes scaleIn {
      0% { transform: scale(0.8); opacity: 0.2; }
      80% { transform: scale(1.08); opacity: 1; }
      100% { transform: scale(1); }
    }
    @keyframes shake {
      0% { transform: translateX(0); }
      20% { transform: translateX(-6px); }
      40% { transform: translateX(6px); }
      60% { transform: translateX(-4px); }
      80% { transform: translateX(4px); }
      100% { transform: translateX(0); }
    }
    @media (max-width: 600px) {
      .card { padding: 18px 6px 12px 6px; min-width: unset; }
      .canvas-wrap { min-width: unset; padding: 6px; }
      .controls { flex-direction: column; gap: 8px; }
      .header-title { font-size: 1.2em; }
      #canvas { width: 98vw; height: 98vw; max-width: 98vw; max-height: 98vw; }
    }
  </style>
  <!-- Google Fonts for Inter -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body>
  <div class="app">
    <div class="card">
      <div class="header">
        <div class="header-title">üìà Coordinate Plane</div>
        <div class="chips">
          <span class="chip" id="score-chip">üéØ 0 | High 0</span>
          <span class="chip" id="streak-chip">‚≠ê 0 | Best 0</span>
        </div>
      </div>
      <div class="level-row" style="width:100%;display:flex;justify-content:center;align-items:center;gap:16px;margin-bottom:8px;">
        <label class="level-label" style="font-weight:600;">Level:</label>
        <label><input type="radio" name="level" value="easy" checked> Easy</label>
        <label><input type="radio" name="level" value="normal"> Normal</label>
        <label><input type="radio" name="level" value="hard"> Hard</label>
      </div>
      <div class="divider"></div>
      <div class="task-badge" id="task">Task: Place the marker at (0, 0)</div>
      <div id="timer-pill" style="display:none;margin-bottom:4px;"></div>
      <div id="challenge-banner" style="display:none;font-weight:700;font-size:1.1em;margin-bottom:4px;"></div>
      <div class="canvas-wrap">
        <canvas id="canvas" width="756" height="756"></canvas>
        <div id="confetti" style="position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;"></div>
      </div>
      <div class="status" id="selected">Selected point: (0, 0)</div>
      <div class="controls">
        <button class="btn" id="check">Check</button>
        <button class="btn" id="newtask">New Task</button>
        <button class="btn" id="restart-hard" style="display:none;">Restart Hard Mode</button>
      </div>
      <div class="feedback" id="feedback"></div>
    </div>
  </div>
  <script>
    // --- Constants ---
    const minCoord = -10, maxCoord = 10;
    const cellSize = 36;
    const canvasSize = cellSize * (maxCoord - minCoord); // 36*20=720
    const canvas = document.getElementById('canvas');
    canvas.width = cellSize * (maxCoord - minCoord + 1); // 36*21=756
    canvas.height = cellSize * (maxCoord - minCoord + 1); // 36*21=756
    const ctx = canvas.getContext('2d');
    const originX = canvas.width / 2;
    const originY = canvas.height / 2;
    const markerRadius = 14;
    // --- State ---
    let marker = { x: 0, y: 0 };
    let dragging = false;
    let offset = { x: 0, y: 0 };
    let task = { x: 0, y: 0 };
    let score = 0, streak = 0;
    let highScore = Number(localStorage.getItem('cp_high_score')) || 0;
    let bestStreak = Number(localStorage.getItem('cp_best_streak')) || 0;
    let level = 'easy';
    let hardMode = false;
    let timer = null;
    let timeLeft = 30;
    let targetsRemaining = 5;
    // --- DOM ---
    const selectedDiv = document.getElementById('selected');
    const taskDiv = document.getElementById('task');
    const feedbackDiv = document.getElementById('feedback');
    const checkBtn = document.getElementById('check');
    const newTaskBtn = document.getElementById('newtask');
    const scoreChip = document.getElementById('score-chip');
    const streakChip = document.getElementById('streak-chip');
    const timerPill = document.getElementById('timer-pill');
    const challengeBanner = document.getElementById('challenge-banner');
    const restartHardBtn = document.getElementById('restart-hard');
    const confettiDiv = document.getElementById('confetti');
    // --- Drawing ---
    function drawPlane() {
      ctx.clearRect(0,0,canvas.width,canvas.height);
      // Grid lines
      ctx.save();
      ctx.strokeStyle = '#e0e0e0';
      ctx.lineWidth = 1;
      for (let i = minCoord; i <= maxCoord; i++) {
        // Vertical
        ctx.beginPath();
        ctx.moveTo(originX + i*cellSize, originY + minCoord*cellSize);
        ctx.lineTo(originX + i*cellSize, originY + maxCoord*cellSize);
        ctx.stroke();
        // Horizontal
        ctx.beginPath();
        ctx.moveTo(originX + minCoord*cellSize, originY - i*cellSize);
        ctx.lineTo(originX + maxCoord*cellSize, originY - i*cellSize);
        ctx.stroke();
      }
      ctx.restore();
      // Axes
      ctx.save();
      ctx.strokeStyle = '#222';
      ctx.lineWidth = 3;
      // X
      ctx.beginPath();
      ctx.moveTo(0, originY);
      ctx.lineTo(canvas.width, originY);
      ctx.stroke();
      // Y
      ctx.beginPath();
      ctx.moveTo(originX, 0);
      ctx.lineTo(originX, canvas.height);
      ctx.stroke();
      ctx.restore();
      // Tick marks
      ctx.save();
      ctx.strokeStyle = '#222';
      ctx.lineWidth = 2;
      for (let i = minCoord; i <= maxCoord; i++) {
        // X ticks
        ctx.beginPath();
        ctx.moveTo(originX + i*cellSize, originY - 6);
        ctx.lineTo(originX + i*cellSize, originY + 6);
        ctx.stroke();
        // Y ticks
        ctx.beginPath();
        ctx.moveTo(originX - 6, originY - i*cellSize);
        ctx.lineTo(originX + 6, originY - i*cellSize);
        ctx.stroke();
      }
      ctx.restore();
      // Axis labels (no duplicates)
      ctx.save();
      ctx.font = 'bold 16px Arial';
      ctx.fillStyle = '#222';
      ctx.textAlign = 'center';
      ctx.textBaseline = 'top';
      for (let i = minCoord; i <= maxCoord; i++) {
        if (i === 0) continue;
        ctx.fillText(i, originX + i*cellSize, originY + 12);
      }
      ctx.textAlign = 'right';
      ctx.textBaseline = 'middle';
      for (let i = minCoord; i <= maxCoord; i++) {
        if (i === 0) continue;
        ctx.fillText(i, originX - 12, originY - i*cellSize);
      }
      // Axis letters
      ctx.font = 'bold 18px Arial';
      ctx.fillStyle = '#1976d2';
      ctx.textAlign = 'left';
      ctx.textBaseline = 'top';
      ctx.fillText('x', canvas.width - 8, originY + 8);
      ctx.textAlign = 'center';
      ctx.textBaseline = 'top';
      ctx.fillText('y', originX, 8);
      ctx.restore();
      // Origin label (only one 0)
      ctx.save();
      ctx.font = 'bold 16px Arial';
      ctx.fillStyle = '#1976d2';
      ctx.textAlign = 'center';
      ctx.textBaseline = 'top';
      ctx.fillText('0', originX, originY + 12);
      ctx.textAlign = 'right';
      ctx.textBaseline = 'middle';
      ctx.fillText('0', originX - 12, originY);
      ctx.restore();
    }
    function drawMarker() {
      ctx.save();
      const px = originX + marker.x * cellSize;
      const py = originY - marker.y * cellSize;
      ctx.beginPath();
      ctx.arc(px, py, markerRadius, 0, 2*Math.PI);
      ctx.fillStyle = dragging ? '#90caf9' : '#fff';
      ctx.strokeStyle = '#1976d2';
      ctx.lineWidth = 3;
      ctx.fill();
      ctx.stroke();
      ctx.restore();
    }
    function render() {
      drawPlane();
      drawMarker();
    }
    // --- Interaction ---
    function updateSelected() {
      selectedDiv.textContent = `Selected point: (${marker.x}, ${marker.y})`;
    }
    // --- Game/Level logic ---
    function updateScore() {
      scoreChip.textContent = `üéØ ${score} | High ${highScore}`;
      streakChip.textContent = `‚≠ê ${streak} | Best ${bestStreak}`;
    }
    function updateTask() {
      taskDiv.textContent = `Task: Place the marker at (${task.x}, ${task.y})`;
    }
    function setFeedback(msg, color) {
      feedbackDiv.textContent = msg;
      feedbackDiv.className = 'feedback';
      if (msg === 'Correct!') {
        feedbackDiv.classList.add('success');
      } else if (msg === 'Incorrect.') {
        feedbackDiv.classList.add('error');
      }
      feedbackDiv.style.color = color;
    }
    function setTimerUI() {
      if (hardMode) {
        timerPill.style.display = '';
        timerPill.innerHTML = `<span style="background:rgba(37,99,235,0.08);border:2px solid var(--blue-600);color:var(--blue-700);border-radius:999px;padding:4px 18px;font-weight:600;display:inline-flex;align-items:center;gap:6px;font-size:1em;"><span>‚è±Ô∏è</span><span id="timer-count">${String(timeLeft).padStart(2,'0')}</span> <span style="font-size:0.95em;">sec</span></span> <span style="margin-left:12px;color:var(--blue-700);font-weight:600;">Targets: ${targetsRemaining}</span>`;
      } else {
        timerPill.style.display = 'none';
      }
    }
    function setChallengeBanner(type) {
      if (type === 'success') {
        challengeBanner.style.display = '';
        challengeBanner.style.color = 'var(--success)';
        challengeBanner.textContent = 'Challenge Complete!';
      } else if (type === 'fail') {
        challengeBanner.style.display = '';
        challengeBanner.style.color = 'var(--error)';
        challengeBanner.textContent = "Time's up ‚Äî try again!";
      } else {
        challengeBanner.style.display = 'none';
      }
    }
    function showConfetti(type) {
      // Simple CSS confetti sprinkle
      confettiDiv.innerHTML = '';
      for (let i=0; i<32; i++) {
        const el = document.createElement('div');
        el.style.position = 'absolute';
        el.style.left = Math.random()*100+'%';
        el.style.top = Math.random()*100+'%';
        el.style.width = '8px';
        el.style.height = '8px';
        el.style.borderRadius = '50%';
        el.style.background = `linear-gradient(135deg, var(--blue-500), var(--blue-700))`;
        el.style.opacity = '0.8';
        el.style.transform = `scale(${0.8+Math.random()*0.6})`;
        el.style.transition = 'all 1.5s cubic-bezier(0.2,0.8,0.2,1)';
        confettiDiv.appendChild(el);
        setTimeout(()=>{
          el.style.top = '110%';
          el.style.opacity = '0';
        }, 50);
      }
      setTimeout(()=>{confettiDiv.innerHTML='';},1500);
    }
    function triggerStreakBadge(streak) {
      if (streak === 5) {
        setFeedback('üî• Streak 5! Keep going!', 'var(--success)');
        showConfetti('streak');
      } else if (streak === 10) {
        setFeedback('üèÜ Streak 10! Awesome!', 'var(--success)');
        showConfetti('streak');
      }
    }
    function saveScores() {
      localStorage.setItem('cp_high_score', highScore);
      localStorage.setItem('cp_best_streak', bestStreak);
    }
    function resetGameState() {
      score = 0;
      streak = 0;
      updateScore();
      setFeedback('', '#333');
      setChallengeBanner();
      confettiDiv.innerHTML = '';
    }
    function generateTask() {
      let x, y;
      if (level === 'easy') {
        x = Math.floor(Math.random()*10)+1;
        y = Math.floor(Math.random()*10)+1;
      } else {
        x = Math.floor(Math.random() * (maxCoord - minCoord + 1)) + minCoord;
        y = Math.floor(Math.random() * (maxCoord - minCoord + 1)) + minCoord;
      }
      task.x = x;
      task.y = y;
      updateTask();
    }
    function startHardMode() {
      hardMode = true;
      timeLeft = 30;
      targetsRemaining = 5;
      setTimerUI();
      setChallengeBanner();
      resetGameState();
      generateTask();
      restartHardBtn.style.display = '';
      newTaskBtn.disabled = true;
      timer = setInterval(()=>{
        timeLeft--;
        setTimerUI();
        if (timeLeft <= 0) {
          clearInterval(timer);
          setChallengeBanner('fail');
          newTaskBtn.disabled = false;
          restartHardBtn.disabled = false;
        }
      },1000);
    }
    function stopHardMode() {
      hardMode = false;
      if (timer) clearInterval(timer);
      setTimerUI();
      setChallengeBanner();
      restartHardBtn.style.display = 'none';
      newTaskBtn.disabled = false;
    }
    // --- Level selector ---
    document.querySelectorAll('input[name="level"]').forEach(radio => {
      radio.onchange = function() {
        level = this.value;
        stopHardMode();
        resetGameState();
        generateTask();
        if (level === 'hard') startHardMode();
      };
    });
    restartHardBtn.onclick = function() {
      stopHardMode();
      startHardMode();
    };
    // --- Game logic ---
    checkBtn.onclick = function() {
      if (marker.x === task.x && marker.y === task.y) {
        setFeedback('Correct!', '#388e3c');
        score++;
        streak++;
        highScore = Math.max(highScore, score);
        bestStreak = Math.max(bestStreak, streak);
        saveScores();
        updateScore();
        if (level === 'hard' && hardMode) {
          targetsRemaining--;
          setTimerUI();
          if (targetsRemaining === 0) {
            setChallengeBanner('success');
            clearInterval(timer);
            newTaskBtn.disabled = false;
            restartHardBtn.disabled = false;
          } else {
            generateTask();
          }
        } else {
          generateTask();
        }
        if (streak === 5 || streak === 10) triggerStreakBadge(streak);
      } else {
        setFeedback('Incorrect.', '#d32f2f');
        streak = 0;
        updateScore();
        if (level === 'hard' && hardMode) {
          // no penalty, just next task
          generateTask();
        }
      }
    };
    newTaskBtn.onclick = function() {
      if (level === 'hard' && hardMode) return;
      generateTask();
      setFeedback('', '#333');
    };
    // --- Init ---
    resetGameState();
    generateTask();
    render();
    updateSelected();
    updateScore();
    updateTask();
    setTimerUI();
    setChallengeBanner();
    // --- Drag logic ---
    let isDragging = false;
    let dragStart = null;
    canvas.addEventListener('mousedown', function(e) {
      const rect = canvas.getBoundingClientRect();
      const mouseX = e.clientX - rect.left;
      const mouseY = e.clientY - rect.top;
      const px = originX + marker.x * cellSize;
      const py = originY - marker.y * cellSize;
      const dist = Math.sqrt((mouseX - px)**2 + (mouseY - py)**2);
      if (dist <= markerRadius + 4) {
        isDragging = true;
        dragStart = { x: mouseX, y: mouseY };
        document.body.style.cursor = 'grabbing';
      }
    });
    canvas.addEventListener('mousemove', function(e) {
      if (!isDragging) return;
      const rect = canvas.getBoundingClientRect();
      const mouseX = e.clientX - rect.left;
      const mouseY = e.clientY - rect.top;
      // Convert to math coords
      let mathX = Math.round((mouseX - originX) / cellSize);
      let mathY = Math.round((originY - mouseY) / cellSize);
      mathX = Math.max(minCoord, Math.min(maxCoord, mathX));
      mathY = Math.max(minCoord, Math.min(maxCoord, mathY));
      marker.x = mathX;
      marker.y = mathY;
      render();
      updateSelected();
    });
    window.addEventListener('mouseup', function() {
      if (isDragging) {
        isDragging = false;
        dragStart = null;
        document.body.style.cursor = '';
        render();
      }
    });
  </script>
</body>
</html>
